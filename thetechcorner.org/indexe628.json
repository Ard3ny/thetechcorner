{"id":1359,"date":"2022-03-04T16:35:00","date_gmt":"2022-03-04T16:35:00","guid":{"rendered":"https:\/\/thetechcorner.org\/?p=1359"},"modified":"2022-03-02T09:02:13","modified_gmt":"2022-03-02T09:02:13","slug":"list-and-identify-selinux-file-and-process-context","status":"publish","type":"post","link":"https:\/\/thetechcorner.org\/?p=1359","title":{"rendered":"List and identify SELinux file and process context"},"content":{"rendered":"\n<p>Processes and files are labeled with an SELinux context that contains additional information, such as an SELinux user, role, type, and, optionally, a level. When running SELinux, all of this information is used to make access control decisions.<\/p>\n\n\n\n<p>So we now know that every file and directory has an SELinux\u00a0<em>context<\/em>. We can display this information by typing<\/p>\n\n\n\n<div class=\"is-layout-flow wp-block-group\"><div class=\"wp-block-group__inner-container\">\n<pre class=\"wp-block-preformatted\">ls -Z \/var<\/pre>\n<\/div><\/div>\n\n\n\n<p>All of this information has a specific meaning, so check out <a href=\"https:\/\/access.redhat.com\/documentation\/en-us\/red_hat_enterprise_linux\/6\/html\/security-enhanced_linux\/chap-security-enhanced_linux-selinux_contexts\">this RH site<\/a> which explains pretty much everything.<\/p>\n\n\n\n<p><\/p>\n\n\n\n<p>Let&#8217;s try this on an <a href=\"https:\/\/github.com\/eightlimbed\/RHCSA-notes\/blob\/master\/list-and-identify-selinux-file-and-process-context.md\">example<\/a><\/p>\n\n\n\n<div class=\"wp-block-image is-style-default\"><figure class=\"aligncenter size-full\"><img decoding=\"async\" loading=\"lazy\" width=\"561\" height=\"26\" src=\"https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-7.png?resize=561%2C26&#038;ssl=1\" alt=\"\" class=\"wp-image-1361\" srcset=\"https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-7.png?w=561&amp;ssl=1 561w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-7.png?resize=300%2C14&amp;ssl=1 300w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-7.png?resize=24%2C1&amp;ssl=1 24w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-7.png?resize=36%2C2&amp;ssl=1 36w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-7.png?resize=48%2C2&amp;ssl=1 48w\" sizes=\"(max-width: 561px) 100vw, 561px\" data-recalc-dims=\"1\" \/><\/figure><\/div>\n\n\n\n<p><code>httpd_sys_content_t<\/code><\/p>\n\n\n\n<ul><li><code>_t<\/code>&nbsp;means its a&nbsp;<strong>type context<\/strong>.<\/li><li><code>httpd_sys_content<\/code>&nbsp;is the&nbsp;<strong>type<\/strong>. It means that&nbsp;<code>httpd<\/code>&nbsp;has permissions to communicate with this dir (<code>\/var\/www\/<\/code>). This is essentially an application layer firewall.<\/li><\/ul>\n\n\n\n<p>All the files inside\u00a0<code>\/var\/www\/<\/code>\u00a0need to have the\u00a0<code>httpd_<\/code>\u00a0context.<\/p>\n\n\n\n<div class=\"wp-block-image is-style-default\"><figure class=\"aligncenter size-full\"><img decoding=\"async\" loading=\"lazy\" width=\"640\" height=\"88\" src=\"https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-8.png?resize=640%2C88&#038;ssl=1\" alt=\"\" class=\"wp-image-1362\" srcset=\"https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-8.png?w=674&amp;ssl=1 674w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-8.png?resize=300%2C41&amp;ssl=1 300w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-8.png?resize=24%2C3&amp;ssl=1 24w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-8.png?resize=36%2C5&amp;ssl=1 36w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-8.png?resize=48%2C7&amp;ssl=1 48w\" sizes=\"(max-width: 640px) 100vw, 640px\" data-recalc-dims=\"1\" \/><\/figure><\/div>\n\n\n\n<h3>Semanage<\/h3>\n\n\n\n<h4>Installing semanage<\/h4>\n\n\n\n<p>Semanage is a tool used to configure SELinux policies<\/p>\n\n\n\n<p>We can find install semanage by installing policy core packages that include it<\/p>\n\n\n\n<div class=\"is-layout-flow wp-block-group\"><div class=\"wp-block-group__inner-container\">\n<pre class=\"wp-block-preformatted\">yum whatprovides *\/semanage<\/pre>\n<\/div><\/div>\n\n\n\n<div class=\"wp-block-image is-style-default\"><figure class=\"aligncenter size-full\"><img decoding=\"async\" loading=\"lazy\" width=\"640\" height=\"269\" src=\"https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-9.png?resize=640%2C269&#038;ssl=1\" alt=\"\" class=\"wp-image-1363\" srcset=\"https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-9.png?w=725&amp;ssl=1 725w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-9.png?resize=300%2C126&amp;ssl=1 300w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-9.png?resize=24%2C10&amp;ssl=1 24w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-9.png?resize=36%2C15&amp;ssl=1 36w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-9.png?resize=48%2C20&amp;ssl=1 48w\" sizes=\"(max-width: 640px) 100vw, 640px\" data-recalc-dims=\"1\" \/><\/figure><\/div>\n\n\n\n<div class=\"is-layout-flow wp-block-group\"><div class=\"wp-block-group__inner-container\">\n<pre class=\"wp-block-preformatted\">yum install policycoreutils-python-utils -y<\/pre>\n<\/div><\/div>\n\n\n\n<p><\/p>\n\n\n\n<h4>Using semanage<\/h4>\n\n\n\n<p><strong>For help we use -h flag<\/strong><\/p>\n\n\n\n<div class=\"is-layout-flow wp-block-group\"><div class=\"wp-block-group__inner-container\">\n<pre class=\"wp-block-preformatted\">semanage -h<\/pre>\n<\/div><\/div>\n\n\n\n<figure class=\"wp-block-image size-full is-style-default\"><img decoding=\"async\" loading=\"lazy\" width=\"640\" height=\"189\" src=\"https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-10.png?resize=640%2C189&#038;ssl=1\" alt=\"\" class=\"wp-image-1364\" srcset=\"https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-10.png?w=737&amp;ssl=1 737w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-10.png?resize=300%2C89&amp;ssl=1 300w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-10.png?resize=24%2C7&amp;ssl=1 24w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-10.png?resize=36%2C11&amp;ssl=1 36w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-10.png?resize=48%2C14&amp;ssl=1 48w\" sizes=\"(max-width: 640px) 100vw, 640px\" data-recalc-dims=\"1\" \/><\/figure>\n\n\n\n<p><\/p>\n\n\n\n<p><strong>Display specific process SELinux context<\/strong><\/p>\n\n\n\n<div class=\"is-layout-flow wp-block-group\"><div class=\"wp-block-group__inner-container\">\n<pre class=\"wp-block-preformatted\">semanage fcontext -l | grep httpd<\/pre>\n<\/div><\/div>\n\n\n\n<div class=\"wp-block-image is-style-default\"><figure class=\"aligncenter size-large\"><img decoding=\"async\" loading=\"lazy\" width=\"640\" height=\"133\" src=\"https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-12.png?resize=640%2C133&#038;ssl=1\" alt=\"\" class=\"wp-image-1366\" srcset=\"https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-12.png?resize=1024%2C213&amp;ssl=1 1024w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-12.png?resize=300%2C63&amp;ssl=1 300w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-12.png?resize=768%2C160&amp;ssl=1 768w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-12.png?resize=24%2C5&amp;ssl=1 24w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-12.png?resize=36%2C8&amp;ssl=1 36w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-12.png?resize=48%2C10&amp;ssl=1 48w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-12.png?w=1060&amp;ssl=1 1060w\" sizes=\"(max-width: 640px) 100vw, 640px\" data-recalc-dims=\"1\" \/><\/figure><\/div>\n\n\n\n<p><strong>Display all processes SELinux context<\/strong><\/p>\n\n\n\n<div class=\"is-layout-flow wp-block-group\"><div class=\"wp-block-group__inner-container\">\n<pre class=\"wp-block-preformatted\">ps auxZ<\/pre>\n<\/div><\/div>\n\n\n\n<div class=\"wp-block-image is-style-default\"><figure class=\"aligncenter size-full\"><img decoding=\"async\" loading=\"lazy\" width=\"640\" height=\"371\" src=\"https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-11.png?resize=640%2C371&#038;ssl=1\" alt=\"\" class=\"wp-image-1365\" srcset=\"https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-11.png?w=680&amp;ssl=1 680w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-11.png?resize=300%2C174&amp;ssl=1 300w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-11.png?resize=24%2C14&amp;ssl=1 24w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-11.png?resize=36%2C21&amp;ssl=1 36w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-11.png?resize=48%2C28&amp;ssl=1 48w\" sizes=\"(max-width: 640px) 100vw, 640px\" data-recalc-dims=\"1\" \/><\/figure><\/div>\n\n\n\n<div class=\"is-layout-flow wp-block-group\"><div class=\"wp-block-group__inner-container\">\n<pre class=\"wp-block-preformatted\">ps auxZ | grep bash<\/pre>\n<\/div><\/div>\n\n\n\n<figure class=\"wp-block-image size-large is-style-default\"><img decoding=\"async\" loading=\"lazy\" width=\"640\" height=\"86\" src=\"https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-13.png?resize=640%2C86&#038;ssl=1\" alt=\"\" class=\"wp-image-1367\" srcset=\"https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-13.png?resize=1024%2C137&amp;ssl=1 1024w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-13.png?resize=300%2C40&amp;ssl=1 300w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-13.png?resize=768%2C103&amp;ssl=1 768w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-13.png?resize=24%2C3&amp;ssl=1 24w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-13.png?resize=36%2C5&amp;ssl=1 36w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-13.png?resize=48%2C6&amp;ssl=1 48w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-13.png?w=1091&amp;ssl=1 1091w\" sizes=\"(max-width: 640px) 100vw, 640px\" data-recalc-dims=\"1\" \/><\/figure>\n","protected":false},"excerpt":{"rendered":"<p>Processes and files are labeled with an SELinux context that contains additional information, such as [&hellip;]<\/p>\n","protected":false},"author":1,"featured_media":1332,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":{"nf_dc_page":"","om_disable_all_campaigns":false,"_mi_skip_tracking":false},"categories":[219],"tags":[477,476,334,269,325,220,329,479],"jetpack_featured_media_url":"https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/02\/rhsa-Manage-security.png?fit=1280%2C720&ssl=1","_links":{"self":[{"href":"https:\/\/thetechcorner.org\/index.php?rest_route=\/wp\/v2\/posts\/1359"}],"collection":[{"href":"https:\/\/thetechcorner.org\/index.php?rest_route=\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/thetechcorner.org\/index.php?rest_route=\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/thetechcorner.org\/index.php?rest_route=\/wp\/v2\/users\/1"}],"replies":[{"embeddable":true,"href":"https:\/\/thetechcorner.org\/index.php?rest_route=%2Fwp%2Fv2%2Fcomments&post=1359"}],"version-history":[{"count":1,"href":"https:\/\/thetechcorner.org\/index.php?rest_route=\/wp\/v2\/posts\/1359\/revisions"}],"predecessor-version":[{"id":1368,"href":"https:\/\/thetechcorner.org\/index.php?rest_route=\/wp\/v2\/posts\/1359\/revisions\/1368"}],"wp:featuredmedia":[{"embeddable":true,"href":"https:\/\/thetechcorner.org\/index.php?rest_route=\/wp\/v2\/media\/1332"}],"wp:attachment":[{"href":"https:\/\/thetechcorner.org\/index.php?rest_route=%2Fwp%2Fv2%2Fmedia&parent=1359"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/thetechcorner.org\/index.php?rest_route=%2Fwp%2Fv2%2Fcategories&post=1359"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/thetechcorner.org\/index.php?rest_route=%2Fwp%2Fv2%2Ftags&post=1359"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}