{"id":985,"date":"2022-01-31T15:52:00","date_gmt":"2022-01-31T15:52:00","guid":{"rendered":"https:\/\/thetechcorner.org\/?p=985"},"modified":"2022-01-30T16:38:47","modified_gmt":"2022-01-30T16:38:47","slug":"create-and-remove-physical-volumes","status":"publish","type":"post","link":"https:\/\/thetechcorner.org\/?p=985","title":{"rendered":"Create and remove physical volumes"},"content":{"rendered":"\n<p><\/p>\n\n\n\n<p>I maybe should have mentioned this in previous post but it doesn&#8217;t really matter, you just need to understand LVM and difference between physical volumes, volume groups and logical volume.<\/p>\n\n\n\n<p class=\"has-text-align-center\"><img decoding=\"async\" loading=\"lazy\" width=\"602\" height=\"343\" src=\"https:\/\/lh4.googleusercontent.com\/m2ojEMHs-NA2xSTamxtL1bc3F25aLCbRsR0uGvrCBV3Z9Q4Ibipl-PDRQqUGEZDqaBl9uoaIrERi3OJRv6TTY--PDercyvpU_GvCm3Mh_9wf4t2Cs6wNHTr0ftvjIYgwaBcIdH0T\"><\/p>\n\n\n\n<p><\/p>\n\n\n\n<p><strong>Logical volume management<\/strong> is a widely-used technique for deploying logical rather than physical storage.<\/p>\n\n\n\n<p>With <strong>LVM,<\/strong> &#8220;logical&#8221; partitions can span across physical hard drives and can be resized (unlike traditional ext3 &#8220;raw&#8221; partitions).<\/p>\n\n\n\n<p>A physical disk is divided into one or more physical volumes (Pvs), and logical volume groups (VGs) are created by combining PVs.<\/p>\n\n\n\n<p><\/p>\n\n\n\n<p><strong>Here are some advantages and disadvantages for using LVM<\/strong><\/p>\n\n\n\n<p><\/p>\n\n\n\n<figure class=\"wp-block-image is-style-default\"><img decoding=\"async\" src=\"https:\/\/i0.wp.com\/i.stack.imgur.com\/cqQl4.png?w=640&#038;ssl=1\" alt=\"enter image description here\" data-recalc-dims=\"1\"\/><\/figure>\n\n\n\n<p><\/p>\n\n\n\n<p>One of the big advantages of LVM is that you can most easily reduce the size of one partition, and use it on other partitions for example, without data loss.<\/p>\n\n\n\n<p>You can also allocate minimal amounts of space for each logical volume and leave some of the disk unallocated. Then, when the partitions start to fill up, they can be expanded as necessary.<\/p>\n\n\n\n<p>From Archlinux wiki:<\/p>\n\n\n\n<p><strong>Advantages<\/strong><\/p>\n\n\n\n<p>LVM gives you more flexibility than just using normal hard drive partitions:<\/p>\n\n\n\n<ol><li>Use any number of disks as one big disk.<\/li><li>Have logical volumes stretched over several disks.<\/li><li>Create small logical volumes and resize them &#8220;dynamically&#8221; as they get more filled.<\/li><li>Resize logical volumes regardless of their order on disk. It does not depend on the position of the LV within VG, there is no need to ensure surrounding available space.<\/li><li>Resize\/create\/delete logical and physical volumes online. File systems on them still need to be resized, but some support online resizing.<\/li><li>Online\/live migration of LV being used by services to different disks without having to restart services.<\/li><li>Snapshots allow you to backup a frozen copy of the file system, while keeping service downtime to a minimum.<\/li><\/ol>\n\n\n\n<p><strong>Disadvantages<\/strong><\/p>\n\n\n\n<ol><li>Linux exclusive (almost). There is no official support in most other OS (FreeBSD, Windows..).<\/li><li>Additional steps in setting up the system, more complicated.<\/li><li>If you use the Btrfs file system, its Subvolume feature will also give you the benefit of having a flexible layout. In that case, using the additional Abstraction layer of LVM may be unnecessary.<\/li><\/ol>\n\n\n\n<p><\/p>\n\n\n\n<h2 id=\"creating-physical-volume\">Creating physical volume<\/h2>\n\n\n\n<p>Let&#8217;s list out the blocks in our system first.<\/p>\n\n\n\n<div class=\"wp-block-image is-style-default\"><figure class=\"aligncenter size-full\"><img decoding=\"async\" loading=\"lazy\" width=\"478\" height=\"261\" src=\"https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/01\/image-221.png?resize=478%2C261&#038;ssl=1\" alt=\"\" class=\"wp-image-986\" srcset=\"https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/01\/image-221.png?w=478&amp;ssl=1 478w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/01\/image-221.png?resize=300%2C164&amp;ssl=1 300w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/01\/image-221.png?resize=24%2C13&amp;ssl=1 24w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/01\/image-221.png?resize=36%2C20&amp;ssl=1 36w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/01\/image-221.png?resize=48%2C26&amp;ssl=1 48w\" sizes=\"(max-width: 478px) 100vw, 478px\" data-recalc-dims=\"1\" \/><\/figure><\/div>\n\n\n\n<p><\/p>\n\n\n\n<p>We can also specifically list out physical volumes with <\/p>\n\n\n\n<div class=\"is-layout-flow wp-block-group\"><div class=\"wp-block-group__inner-container\">\n<pre class=\"wp-block-preformatted\">pvdisplay<\/pre>\n<\/div><\/div>\n\n\n\n<div class=\"wp-block-image is-style-default\"><figure class=\"aligncenter size-full\"><img decoding=\"async\" loading=\"lazy\" width=\"640\" height=\"239\" src=\"https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/01\/image-222.png?resize=640%2C239&#038;ssl=1\" alt=\"\" class=\"wp-image-987\" srcset=\"https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/01\/image-222.png?w=642&amp;ssl=1 642w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/01\/image-222.png?resize=300%2C112&amp;ssl=1 300w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/01\/image-222.png?resize=24%2C9&amp;ssl=1 24w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/01\/image-222.png?resize=36%2C13&amp;ssl=1 36w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/01\/image-222.png?resize=48%2C18&amp;ssl=1 48w\" sizes=\"(max-width: 640px) 100vw, 640px\" data-recalc-dims=\"1\" \/><\/figure><\/div>\n\n\n\n<p><\/p>\n\n\n\n<p>As you can see, I only have one physical volume, which is my main \/dev\/sda1. Let&#8217;s add another disk to the physical volume. Mine is called sdb1 or sdc1, but yours will probably be different. <\/p>\n\n\n\n<div class=\"is-layout-flow wp-block-group\"><div class=\"wp-block-group__inner-container\">\n<pre class=\"wp-block-preformatted\">pvcreate \/dev\/sdb1<\/pre>\n<\/div><\/div>\n\n\n\n<div class=\"wp-block-image is-style-default\"><figure class=\"aligncenter size-full\"><img decoding=\"async\" loading=\"lazy\" width=\"496\" height=\"48\" src=\"https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/01\/image-223.png?resize=496%2C48&#038;ssl=1\" alt=\"\" class=\"wp-image-988\" srcset=\"https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/01\/image-223.png?w=496&amp;ssl=1 496w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/01\/image-223.png?resize=300%2C29&amp;ssl=1 300w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/01\/image-223.png?resize=24%2C2&amp;ssl=1 24w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/01\/image-223.png?resize=36%2C3&amp;ssl=1 36w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/01\/image-223.png?resize=48%2C5&amp;ssl=1 48w\" sizes=\"(max-width: 496px) 100vw, 496px\" data-recalc-dims=\"1\" \/><\/figure><\/div>\n\n\n\n<div class=\"wp-block-image is-style-default\"><figure class=\"aligncenter size-full\"><img decoding=\"async\" loading=\"lazy\" width=\"640\" height=\"232\" src=\"https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/01\/image-225.png?resize=640%2C232&#038;ssl=1\" alt=\"\" class=\"wp-image-990\" srcset=\"https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/01\/image-225.png?w=676&amp;ssl=1 676w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/01\/image-225.png?resize=300%2C109&amp;ssl=1 300w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/01\/image-225.png?resize=24%2C9&amp;ssl=1 24w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/01\/image-225.png?resize=36%2C13&amp;ssl=1 36w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/01\/image-225.png?resize=48%2C17&amp;ssl=1 48w\" sizes=\"(max-width: 640px) 100vw, 640px\" data-recalc-dims=\"1\" \/><\/figure><\/div>\n\n\n\n<p><\/p>\n\n\n\n<p>As you can see, we have a new physical volume with the name \/dev\/sdb1<\/p>\n\n\n\n<p><\/p>\n\n\n\n<h2 id=\"removing-physical-volume\">Removing physical volume<\/h2>\n\n\n\n<p>To remove our physical volume, we use command<\/p>\n\n\n\n<div class=\"is-layout-flow wp-block-group\"><div class=\"wp-block-group__inner-container\">\n<pre class=\"wp-block-preformatted\">pvremove \/dev\/sdb1<\/pre>\n<\/div><\/div>\n\n\n\n<div class=\"wp-block-image is-style-default\"><figure class=\"aligncenter size-full\"><img decoding=\"async\" loading=\"lazy\" width=\"541\" height=\"62\" src=\"https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/01\/image-226.png?resize=541%2C62&#038;ssl=1\" alt=\"\" class=\"wp-image-991\" srcset=\"https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/01\/image-226.png?w=541&amp;ssl=1 541w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/01\/image-226.png?resize=300%2C34&amp;ssl=1 300w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/01\/image-226.png?resize=24%2C3&amp;ssl=1 24w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/01\/image-226.png?resize=36%2C4&amp;ssl=1 36w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/01\/image-226.png?resize=48%2C6&amp;ssl=1 48w\" sizes=\"(max-width: 541px) 100vw, 541px\" data-recalc-dims=\"1\" \/><\/figure><\/div>\n\n\n\n<p><\/p>\n\n\n\n<p>Now that we have physical volume, we can continue with adding this volume to the volume group.<\/p>\n","protected":false},"excerpt":{"rendered":"<p>I maybe should have mentioned this in previous post but it doesn&#8217;t really matter, you [&hellip;]<\/p>\n","protected":false},"author":1,"featured_media":982,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":{"nf_dc_page":"","om_disable_all_campaigns":false,"_mi_skip_tracking":false},"categories":[219],"tags":[263,371,370,220,372],"jetpack_featured_media_url":"https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/01\/rhsa-configure-local-storage.png?fit=1280%2C720&ssl=1","_links":{"self":[{"href":"https:\/\/thetechcorner.org\/index.php?rest_route=\/wp\/v2\/posts\/985"}],"collection":[{"href":"https:\/\/thetechcorner.org\/index.php?rest_route=\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/thetechcorner.org\/index.php?rest_route=\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/thetechcorner.org\/index.php?rest_route=\/wp\/v2\/users\/1"}],"replies":[{"embeddable":true,"href":"https:\/\/thetechcorner.org\/index.php?rest_route=%2Fwp%2Fv2%2Fcomments&post=985"}],"version-history":[{"count":1,"href":"https:\/\/thetechcorner.org\/index.php?rest_route=\/wp\/v2\/posts\/985\/revisions"}],"predecessor-version":[{"id":992,"href":"https:\/\/thetechcorner.org\/index.php?rest_route=\/wp\/v2\/posts\/985\/revisions\/992"}],"wp:featuredmedia":[{"embeddable":true,"href":"https:\/\/thetechcorner.org\/index.php?rest_route=\/wp\/v2\/media\/982"}],"wp:attachment":[{"href":"https:\/\/thetechcorner.org\/index.php?rest_route=%2Fwp%2Fv2%2Fmedia&parent=985"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/thetechcorner.org\/index.php?rest_route=%2Fwp%2Fv2%2Fcategories&post=985"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/thetechcorner.org\/index.php?rest_route=%2Fwp%2Fv2%2Ftags&post=985"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}