{"id":556,"date":"2021-12-17T17:49:10","date_gmt":"2021-12-17T17:49:10","guid":{"rendered":"https:\/\/thetechcorner.org\/?p=556"},"modified":"2022-01-04T09:26:47","modified_gmt":"2022-01-04T09:26:47","slug":"raspberry-pi-automatically-controlled-fan","status":"publish","type":"post","link":"https:\/\/thetechcorner.org\/?p=556","title":{"rendered":"Raspberry PI &#8211; Automatically Controlled Fan"},"content":{"rendered":"\n<p>With the new Raspberry Pi 4 and it&#8217;s CPU, Raspberry tends to get really hot. Adding a fan can significantly help this problem, but there is going to be an issue with the annoying buzzing sound of the small fan.<\/p>\n\n\n\n<p>In this guide, I&#8217;ll show you how to set up this fan, so it&#8217;s only starting working when the PI will get hot.<\/p>\n\n\n\n<p><\/p>\n\n\n\n<h3><strong>1<\/strong>.&nbsp;<strong>First, you will need a few things:<\/strong><\/h3>\n\n\n\n<ol><li>Raspberry Pi (any model will do for this)<\/li><li>SD card \/ USB<\/li><li>Power supply<\/li><li>Ethernet Cable (you could also you a wifi, but Ethernet is just way better in performance and reliability<\/li><li>Small fan &#8211; 5V<\/li><li>Few cables and soldering iron<\/li><li>NPN transistor (2N2222) &#8211; 680\u03a9<\/li><\/ol>\n\n\n\n<p><\/p>\n\n\n\n<h3><strong>2. Seting up your your PI.<\/strong><\/h3>\n\n\n\n<p>You can find guide for that&nbsp;<a href=\"https:\/\/thetechcorner.org\/?p=136\">here<\/a>!<\/p>\n\n\n\n<p><\/p>\n\n\n\n<h3><strong>3. Connecting the circuit<\/strong><\/h3>\n\n\n\n<p>In this step, I&#8217;ll explain the circuit and a step-by-step guide to connecting it right. <\/p>\n\n\n\n<p>Because the fan requirement of the 5V and the Pi capability of providing 3.3V at max, we added a NPN transistor. We could just use dedicated 5V pins that are  on the PI, but they don&#8217;t have regulation capability build into them. That&#8217;s why we are going to use GPIO pins.<\/p>\n\n\n\n<p>The transistor is an electrical component used in circuits to switch or amplify power. In our case, it&#8217;s going to be switch. <\/p>\n\n\n\n<p>We are going to connect the positive lead aka Emitor (E )to 5v+ on the PI and the collector (C ) to the ground on the PI. Last but not least, we are going to connect the base (B ) of the transistor to the PIN 17 and place a 680 Ohm resistor between them. You can see which leg of the NPN transistor is what on the picture below as well as the GPIO name scheme of the PI<\/p>\n\n\n\n<div class=\"wp-block-image is-style-default\"><figure class=\"aligncenter size-full\"><img decoding=\"async\" loading=\"lazy\" width=\"346\" height=\"346\" src=\"https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2021\/12\/image-21.png?resize=346%2C346&#038;ssl=1\" alt=\"\" class=\"wp-image-571\" srcset=\"https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2021\/12\/image-21.png?w=346&amp;ssl=1 346w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2021\/12\/image-21.png?resize=300%2C300&amp;ssl=1 300w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2021\/12\/image-21.png?resize=150%2C150&amp;ssl=1 150w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2021\/12\/image-21.png?resize=24%2C24&amp;ssl=1 24w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2021\/12\/image-21.png?resize=36%2C36&amp;ssl=1 36w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2021\/12\/image-21.png?resize=48%2C48&amp;ssl=1 48w\" sizes=\"(max-width: 346px) 100vw, 346px\" data-recalc-dims=\"1\" \/><\/figure><\/div>\n\n\n\n<div class=\"is-layout-flow wp-block-group\"><div class=\"wp-block-group__inner-container\">\n<figure class=\"wp-block-image size-full is-resized is-style-default\"><img decoding=\"async\" loading=\"lazy\" src=\"https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2021\/12\/image-17.png?resize=640%2C338&#038;ssl=1\" alt=\"\" class=\"wp-image-567\" width=\"640\" height=\"338\" srcset=\"https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2021\/12\/image-17.png?w=664&amp;ssl=1 664w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2021\/12\/image-17.png?resize=300%2C159&amp;ssl=1 300w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2021\/12\/image-17.png?resize=24%2C13&amp;ssl=1 24w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2021\/12\/image-17.png?resize=36%2C19&amp;ssl=1 36w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2021\/12\/image-17.png?resize=48%2C25&amp;ssl=1 48w\" sizes=\"(max-width: 640px) 100vw, 640px\" data-recalc-dims=\"1\" \/><\/figure>\n<\/div><\/div>\n\n\n\n<p><\/p>\n\n\n\n<p>Finally, the final wired up product should look like this.<\/p>\n\n\n\n<figure class=\"wp-block-image size-full is-style-default\"><img decoding=\"async\" loading=\"lazy\" width=\"640\" height=\"484\" src=\"https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2021\/12\/image-18.png?resize=640%2C484&#038;ssl=1\" alt=\"\" class=\"wp-image-568\" srcset=\"https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2021\/12\/image-18.png?w=683&amp;ssl=1 683w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2021\/12\/image-18.png?resize=300%2C227&amp;ssl=1 300w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2021\/12\/image-18.png?resize=24%2C18&amp;ssl=1 24w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2021\/12\/image-18.png?resize=36%2C27&amp;ssl=1 36w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2021\/12\/image-18.png?resize=48%2C36&amp;ssl=1 48w\" sizes=\"(max-width: 640px) 100vw, 640px\" data-recalc-dims=\"1\" \/><\/figure>\n\n\n\n<p><\/p>\n\n\n\n<p>Here is my PI with the hot glue used to keep everything together and protected. It doesn&#8217;t look the nicest, but it gets the job done, and it&#8217;s pretty reliable. <\/p>\n\n\n\n<figure class=\"wp-block-image size-large is-style-default\"><img decoding=\"async\" loading=\"lazy\" width=\"640\" height=\"389\" src=\"https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2021\/12\/image-16.png?resize=640%2C389&#038;ssl=1\" alt=\"\" class=\"wp-image-566\" srcset=\"https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2021\/12\/image-16.png?resize=1024%2C623&amp;ssl=1 1024w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2021\/12\/image-16.png?resize=300%2C182&amp;ssl=1 300w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2021\/12\/image-16.png?resize=768%2C467&amp;ssl=1 768w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2021\/12\/image-16.png?resize=24%2C15&amp;ssl=1 24w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2021\/12\/image-16.png?resize=36%2C22&amp;ssl=1 36w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2021\/12\/image-16.png?resize=48%2C29&amp;ssl=1 48w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2021\/12\/image-16.png?w=1514&amp;ssl=1 1514w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2021\/12\/image-16.png?w=1280&amp;ssl=1 1280w\" sizes=\"(max-width: 640px) 100vw, 640px\" data-recalc-dims=\"1\" \/><\/figure>\n\n\n\n<h3><strong>4. Script for a fan<\/strong><\/h3>\n\n\n\n<p>First, we will need to install a python 3 for our script to work.<\/p>\n\n\n\n<div class=\"is-layout-flow wp-block-group\"><div class=\"wp-block-group__inner-container\">\n<pre class=\"wp-block-preformatted\"><strong>sudo apt install python3-pip<\/strong><\/pre>\n<\/div><\/div>\n\n\n\n<p>Next, we will be using a script that some gentleman already wrote for us. Just copy and paste this command into your PI<\/p>\n\n\n\n<div class=\"is-layout-flow wp-block-group\"><div class=\"wp-block-group__inner-container\">\n<pre class=\"wp-block-code\"><code><strong>git clone https:\/\/github.com\/Howchoo\/pi-fan-controller.git<\/strong><\/code><\/pre>\n<\/div><\/div>\n\n\n\n<p><\/p>\n\n\n\n<p>We will need to install a few more packages, this process is already automated, so you just have to type<\/p>\n\n\n\n<div class=\"is-layout-flow wp-block-group\"><div class=\"wp-block-group__inner-container\">\n<pre class=\"wp-block-code\"><code><strong>sudo pip3 install -r pi-fan-controller\/requirements.txt<\/strong><\/code><\/pre>\n<\/div><\/div>\n\n\n\n<p>And finally start the script, that will automatically configure everything<\/p>\n\n\n\n<div class=\"is-layout-flow wp-block-group\"><div class=\"wp-block-group__inner-container\">\n<pre class=\"wp-block-code\"><code><strong>.\/pi-fan-controller\/script\/install<\/strong><\/code><\/pre>\n\n\n\n<p><\/p>\n<\/div><\/div>\n\n\n\n<p>Everything should be working now. To test this, we will use a stress test and measure the temperature along with it. In one terminal type:<\/p>\n\n\n\n<div class=\"is-layout-flow wp-block-group\"><div class=\"wp-block-group__inner-container\">\n<pre class=\"wp-block-preformatted\"><strong>sudo apt-get install stress<\/strong>\n<strong>sudo stress --cpu 8 --timeout 60<\/strong><\/pre>\n\n\n\n<p><\/p>\n\n\n\n<p>And in the other window terminal we will measure the temperature and watch fans if they spin on in time:<\/p>\n<\/div><\/div>\n\n\n\n<div class=\"is-layout-flow wp-block-group\"><div class=\"wp-block-group__inner-container\">\n<pre class=\"wp-block-preformatted\"><strong>watch -n 1 vcgencmd measure_temp<\/strong><\/pre>\n<\/div><\/div>\n\n\n\n<p>If everything goes correctly, a fan should turn on when temperature hits the 65\u00b0 C<\/p>\n\n\n\n<figure class=\"wp-block-image size-large is-style-default\"><img decoding=\"async\" loading=\"lazy\" width=\"640\" height=\"186\" src=\"https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2021\/12\/image-13.png?resize=640%2C186&#038;ssl=1\" alt=\"\" class=\"wp-image-557\" srcset=\"https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2021\/12\/image-13.png?resize=1024%2C298&amp;ssl=1 1024w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2021\/12\/image-13.png?resize=300%2C87&amp;ssl=1 300w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2021\/12\/image-13.png?resize=768%2C223&amp;ssl=1 768w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2021\/12\/image-13.png?resize=24%2C7&amp;ssl=1 24w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2021\/12\/image-13.png?resize=36%2C10&amp;ssl=1 36w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2021\/12\/image-13.png?resize=48%2C14&amp;ssl=1 48w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2021\/12\/image-13.png?w=1413&amp;ssl=1 1413w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2021\/12\/image-13.png?w=1280&amp;ssl=1 1280w\" sizes=\"(max-width: 640px) 100vw, 640px\" data-recalc-dims=\"1\" \/><\/figure>\n\n\n\n<p><\/p>\n\n\n\n<p><\/p>\n\n\n\n<p>You can change the threshold of the fan settings by opening fancontrol.py config file and rewriting the temperatures: <\/p>\n\n\n\n<div class=\"is-layout-flow wp-block-group\"><div class=\"wp-block-group__inner-container\">\n<pre class=\"wp-block-preformatted\"><strong>sudo vi \/usr\/local\/bin\/fancontrol.py<\/strong><\/pre>\n\n\n\n<figure class=\"wp-block-image size-full is-style-default\"><img decoding=\"async\" loading=\"lazy\" width=\"601\" height=\"111\" src=\"https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2021\/12\/image-14.png?resize=601%2C111&#038;ssl=1\" alt=\"\" class=\"wp-image-558\" srcset=\"https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2021\/12\/image-14.png?w=601&amp;ssl=1 601w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2021\/12\/image-14.png?resize=300%2C55&amp;ssl=1 300w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2021\/12\/image-14.png?resize=24%2C4&amp;ssl=1 24w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2021\/12\/image-14.png?resize=36%2C7&amp;ssl=1 36w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2021\/12\/image-14.png?resize=48%2C9&amp;ssl=1 48w\" sizes=\"(max-width: 601px) 100vw, 601px\" data-recalc-dims=\"1\" \/><\/figure>\n\n\n\n<p><\/p>\n\n\n\n<p>Your Pi should now be able to automatically control the fan, so both of you can be cool now. <\/p>\n<\/div><\/div>\n","protected":false},"excerpt":{"rendered":"<p>With the new Raspberry Pi 4 and it&#8217;s CPU, Raspberry tends to get really hot. [&hellip;]<\/p>\n","protected":false},"author":1,"featured_media":574,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":{"nf_dc_page":"","om_disable_all_campaigns":false,"_mi_skip_tracking":false},"categories":[96],"tags":[216,214,110,112],"jetpack_featured_media_url":"https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2021\/12\/automatically-controled-fan.png?fit=1280%2C720&ssl=1","_links":{"self":[{"href":"https:\/\/thetechcorner.org\/index.php?rest_route=\/wp\/v2\/posts\/556"}],"collection":[{"href":"https:\/\/thetechcorner.org\/index.php?rest_route=\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/thetechcorner.org\/index.php?rest_route=\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/thetechcorner.org\/index.php?rest_route=\/wp\/v2\/users\/1"}],"replies":[{"embeddable":true,"href":"https:\/\/thetechcorner.org\/index.php?rest_route=%2Fwp%2Fv2%2Fcomments&post=556"}],"version-history":[{"count":4,"href":"https:\/\/thetechcorner.org\/index.php?rest_route=\/wp\/v2\/posts\/556\/revisions"}],"predecessor-version":[{"id":652,"href":"https:\/\/thetechcorner.org\/index.php?rest_route=\/wp\/v2\/posts\/556\/revisions\/652"}],"wp:featuredmedia":[{"embeddable":true,"href":"https:\/\/thetechcorner.org\/index.php?rest_route=\/wp\/v2\/media\/574"}],"wp:attachment":[{"href":"https:\/\/thetechcorner.org\/index.php?rest_route=%2Fwp%2Fv2%2Fmedia&parent=556"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/thetechcorner.org\/index.php?rest_route=%2Fwp%2Fv2%2Fcategories&post=556"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/thetechcorner.org\/index.php?rest_route=%2Fwp%2Fv2%2Ftags&post=556"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}