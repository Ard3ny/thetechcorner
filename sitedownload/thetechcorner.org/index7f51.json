{"id":1369,"date":"2022-03-05T16:28:00","date_gmt":"2022-03-05T16:28:00","guid":{"rendered":"https:\/\/thetechcorner.org\/?p=1369"},"modified":"2022-03-03T12:10:50","modified_gmt":"2022-03-03T12:10:50","slug":"restore-default-file-contexts","status":"publish","type":"post","link":"https:\/\/thetechcorner.org\/?p=1369","title":{"rendered":"<strong>Restore default file contexts<\/strong>"},"content":{"rendered":"\n<p>I&#8217;ve talked about SELinux file and process context in the last post. Now let&#8217;s try to change some file context and restore it afterwords.<\/p>\n\n\n\n<p><\/p>\n\n\n\n<p>First, let&#8217;s create a directory in the root folder and list SELinux info with ls command<\/p>\n\n\n\n<div class=\"is-layout-flow wp-block-group\"><div class=\"wp-block-group__inner-container\">\n<pre class=\"wp-block-preformatted\">mkdir \/test<\/pre>\n<\/div><\/div>\n\n\n\n<figure class=\"wp-block-image size-full is-style-default\"><img decoding=\"async\" loading=\"lazy\" width=\"640\" height=\"288\" src=\"https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-15.png?resize=640%2C288&#038;ssl=1\" alt=\"\" class=\"wp-image-1371\" srcset=\"https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-15.png?w=920&amp;ssl=1 920w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-15.png?resize=300%2C135&amp;ssl=1 300w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-15.png?resize=768%2C346&amp;ssl=1 768w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-15.png?resize=24%2C11&amp;ssl=1 24w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-15.png?resize=36%2C16&amp;ssl=1 36w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-15.png?resize=48%2C22&amp;ssl=1 48w\" sizes=\"(max-width: 640px) 100vw, 640px\" data-recalc-dims=\"1\" \/><\/figure>\n\n\n\n<p><\/p>\n\n\n\n<blockquote class=\"wp-block-quote\"><p>By default, newly-created files and directories inherit the SELinux type of their parent directories. For example, when creating a new file in the\u00a0<code>\/<\/code>etc\u00a0directory that is labeled with the\u00a0<code>etc_t<\/code>\u00a0type, the new file inherits the same type<\/p><\/blockquote>\n\n\n\n<p><\/p>\n\n\n\n<p><strong>Changing SELinux context of the file<\/strong><\/p>\n\n\n\n<p>The\u00a0<code>chcon<\/code>\u00a0command changes the SELinux context for files. However, changes made with the\u00a0<code>chcon<\/code>\u00a0command are not persistent across file-system relabels, or the execution of the\u00a0<code>restorecon<\/code>\u00a0command.<\/p>\n\n\n\n<p>Run the\u00a0<code>chcon -t <em>type<\/em> <em>file-name<\/em><\/code>\u00a0command to change the file type, where\u00a0<em>type<\/em>\u00a0is an SELinux type, such as\u00a0<code>httpd_sys_content_t<\/code>, and\u00a0<em>file-name<\/em>\u00a0is a file or directory name:<\/p>\n\n\n\n<div class=\"is-layout-flow wp-block-group\"><div class=\"wp-block-group__inner-container\">\n<pre class=\"wp-block-preformatted\">chcon -t <em>type<\/em> <em>file-name<\/em><\/pre>\n<\/div><\/div>\n\n\n\n<ul><li>Run the\u00a0<code>chcon -R -t <em>type<\/em> <em>directory-name<\/em><\/code>\u00a0command to change the type of the directory and its contents, where\u00a0<em>type<\/em>\u00a0is an SELinux type, such as\u00a0<code>httpd_sys_content_t<\/code>, and\u00a0<em>directory-name<\/em>\u00a0is a directory name:<code>~]$<\/code> <code>chcon -R -t httpd_sys_content_t <em>directory-name<\/em><\/code><\/li><\/ul>\n\n\n\n<p><\/p>\n\n\n\n<p>So in our case, we use chcon command to change type of our \/test directory to <code>httpd_sys_content_t<\/code><\/p>\n\n\n\n<div class=\"is-layout-flow wp-block-group\"><div class=\"wp-block-group__inner-container\">\n<pre class=\"wp-block-preformatted\">chcon -R -t httpd_sys_content_t \/test\/<\/pre>\n<\/div><\/div>\n\n\n\n<div class=\"wp-block-image is-style-default\"><figure class=\"aligncenter size-full\"><img decoding=\"async\" loading=\"lazy\" width=\"640\" height=\"52\" src=\"https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-16.png?resize=640%2C52&#038;ssl=1\" alt=\"\" class=\"wp-image-1372\" srcset=\"https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-16.png?w=931&amp;ssl=1 931w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-16.png?resize=300%2C24&amp;ssl=1 300w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-16.png?resize=768%2C62&amp;ssl=1 768w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-16.png?resize=24%2C2&amp;ssl=1 24w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-16.png?resize=36%2C3&amp;ssl=1 36w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-16.png?resize=48%2C4&amp;ssl=1 48w\" sizes=\"(max-width: 640px) 100vw, 640px\" data-recalc-dims=\"1\" \/><\/figure><\/div>\n\n\n\n<p><\/p>\n\n\n\n<p><strong>Restore default SELinux context<\/strong><\/p>\n\n\n\n<div class=\"is-layout-flow wp-block-group\"><div class=\"wp-block-group__inner-container\">\n<pre class=\"wp-block-preformatted\">restorecon -R -v \/test\/<\/pre>\n<\/div><\/div>\n\n\n\n<figure class=\"wp-block-image size-full is-style-default\"><img decoding=\"async\" loading=\"lazy\" width=\"640\" height=\"38\" src=\"https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-17.png?resize=640%2C38&#038;ssl=1\" alt=\"\" class=\"wp-image-1373\" srcset=\"https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-17.png?w=971&amp;ssl=1 971w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-17.png?resize=300%2C18&amp;ssl=1 300w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-17.png?resize=768%2C46&amp;ssl=1 768w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-17.png?resize=24%2C1&amp;ssl=1 24w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-17.png?resize=36%2C2&amp;ssl=1 36w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-17.png?resize=48%2C3&amp;ssl=1 48w\" sizes=\"(max-width: 640px) 100vw, 640px\" data-recalc-dims=\"1\" \/><\/figure>\n\n\n\n<p><\/p>\n\n\n\n<p><\/p>\n\n\n\n<blockquote class=\"wp-block-quote\"><p><strong>restorecon FILE will set the security context for a FILE based on where it is in the filesystem to the default SELinux settings.<\/strong><\/p><p><strong>\/.autorelabel is a file in \/ that will configure SELinux to <em>relabel<\/em> every file on our filesystem when we reboot.<\/strong><\/p><\/blockquote>\n","protected":false},"excerpt":{"rendered":"<p>I&#8217;ve talked about SELinux file and process context in the last post. Now let&#8217;s try [&hellip;]<\/p>\n","protected":false},"author":1,"featured_media":1332,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":{"nf_dc_page":"","om_disable_all_campaigns":false,"_mi_skip_tracking":false},"categories":[219],"tags":[484,483,481,476,480,482,329],"jetpack_featured_media_url":"https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/02\/rhsa-Manage-security.png?fit=1280%2C720&ssl=1","_links":{"self":[{"href":"https:\/\/thetechcorner.org\/index.php?rest_route=\/wp\/v2\/posts\/1369"}],"collection":[{"href":"https:\/\/thetechcorner.org\/index.php?rest_route=\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/thetechcorner.org\/index.php?rest_route=\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/thetechcorner.org\/index.php?rest_route=\/wp\/v2\/users\/1"}],"replies":[{"embeddable":true,"href":"https:\/\/thetechcorner.org\/index.php?rest_route=%2Fwp%2Fv2%2Fcomments&post=1369"}],"version-history":[{"count":1,"href":"https:\/\/thetechcorner.org\/index.php?rest_route=\/wp\/v2\/posts\/1369\/revisions"}],"predecessor-version":[{"id":1374,"href":"https:\/\/thetechcorner.org\/index.php?rest_route=\/wp\/v2\/posts\/1369\/revisions\/1374"}],"wp:featuredmedia":[{"embeddable":true,"href":"https:\/\/thetechcorner.org\/index.php?rest_route=\/wp\/v2\/media\/1332"}],"wp:attachment":[{"href":"https:\/\/thetechcorner.org\/index.php?rest_route=%2Fwp%2Fv2%2Fmedia&parent=1369"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/thetechcorner.org\/index.php?rest_route=%2Fwp%2Fv2%2Fcategories&post=1369"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/thetechcorner.org\/index.php?rest_route=%2Fwp%2Fv2%2Ftags&post=1369"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}