{"id":1459,"date":"2022-03-21T21:20:43","date_gmt":"2022-03-21T21:20:43","guid":{"rendered":"https:\/\/thetechcorner.org\/?p=1459"},"modified":"2022-03-21T21:20:48","modified_gmt":"2022-03-21T21:20:48","slug":"running-unify-controller-on-the-raspberry-pi","status":"publish","type":"post","link":"https:\/\/thetechcorner.org\/?p=1459","title":{"rendered":"Running Unify Controller on the Raspberry Pi"},"content":{"rendered":"\n<p>If you are like me, and you own some Ubiquiti AP, you&#8217;ve probably come across Unify controller while installing\/setting up your wireless router.<\/p>\n\n\n\n<p>Unify controller is &nbsp;<strong>a wireless network management software solution from Ubiquiti Networks\u2122<\/strong>. It allows you to manage multiple wireless networks using a web browser. The Sample Network Diagram above illustrates an example of a single UniFi network.<\/p>\n\n\n\n<p><\/p>\n\n\n\n<p>It&#8217;s a very useful piece of software, but it needs an external device to be working. You could use your main PC as the host, but I don&#8217;t know about you, but I for sure am not running my main PC 24\/7. To fix this we can use Raspberry Pi, which is maybe already running PI-hole or NFS and so it won&#8217;t make difference on your electric bill.<\/p>\n\n\n\n<p><\/p>\n\n\n\n<h2><strong>1.<\/strong>&nbsp;<strong>Set-up Raspberry PI<\/strong><\/h2>\n\n\n\n<p>I have already created a tutorial for this step, which you can check out&nbsp;<a href=\"https:\/\/thetechcorner.org\/?p=136\">here<\/a>. You can configure PI&nbsp;<strong>with or without a monitor<\/strong>.<\/p>\n\n\n\n<p>Next, you can check out some other guides on how to&nbsp;<a href=\"https:\/\/thetechcorner.org\/?p=177\">change your hostname and password<\/a>&nbsp;or&nbsp;<a href=\"https:\/\/thetechcorner.org\/?p=177\">how you can overclock your Raspberry PI<\/a>&nbsp;for better performance.<\/p>\n\n\n\n<p><strong>If you have already set-up your Raspberry, you only need to update your Raspbian<\/strong>&nbsp;<strong>packages and version using<\/strong>&nbsp;<strong>these commands<\/strong><\/p>\n\n\n\n<div class=\"is-layout-flow wp-block-group\"><div class=\"wp-block-group__inner-container\">\n<pre class=\"wp-block-preformatted\">sudo apt update\nsudo apt upgrade<\/pre>\n<\/div><\/div>\n\n\n\n<p><\/p>\n\n\n\n<h2><strong>2. Install necessary packages<\/strong><\/h2>\n\n\n\n<p>As our next step, we need to install a few things to be to run Unify controller.<\/p>\n\n\n\n<p>The first one is Java runtime environment 8, we cannot go with any newer version yet, because the UniFi controller doesn&#8217;t support it.<\/p>\n\n\n\n<div class=\"is-layout-flow wp-block-group\"><div class=\"wp-block-group__inner-container\">\n<pre class=\"wp-block-preformatted\">sudo apt install openjdk-8-jre-headless<\/pre>\n<\/div><\/div>\n\n\n\n<p><\/p>\n\n\n\n<p>To improve UniFi controller startup speed, we can install rng-tools which is a set of utilities related to random number generation in kernel. The main program is rngd,&nbsp;<strong>a daemon developed to check and feed random data from hardware device to kernel entropy pool<\/strong>. This is mainly useful to increase the quantity of entropy in kernel to make \/dev\/random faster<\/p>\n\n\n\n<div class=\"is-layout-flow wp-block-group\"><div class=\"wp-block-group__inner-container\">\n<pre class=\"wp-block-preformatted\">sudo apt install rng-tools<\/pre>\n<\/div><\/div>\n\n\n\n<p>But it won&#8217;t work just yet, first we need to uncomment the <em>HRNGDEVICE=\/dev\/hwrng<\/em> line to define input source for random data.<\/p>\n\n\n\n<div class=\"is-layout-flow wp-block-group\"><div class=\"wp-block-group__inner-container\">\n<pre class=\"wp-block-preformatted\">sudo vi \/etc\/default\/rng-tools-debian<\/pre>\n<\/div><\/div>\n\n\n\n<p><strong>And find #<em>HRNGDEVICE=\/dev\/hwrng<\/em> and remove the hastag.<\/strong><\/p>\n\n\n\n<p>Save the file and restart the rng-tools service<\/p>\n\n\n\n<div class=\"is-layout-flow wp-block-group\"><div class=\"wp-block-group__inner-container\">\n<pre class=\"wp-block-preformatted\">sudo systemctl restart rng-tools<\/pre>\n<\/div><\/div>\n\n\n\n<h2><strong>3. Fixing the mangodb dependency issue<\/strong><\/h2>\n\n\n\n<p>As the last thing of our preparation to install the UniFi Controller, we need to fix <em>mangodb <\/em>dependency issue, which you would get when trying to install it.<\/p>\n\n\n\n<div class=\"wp-block-image is-style-default\"><figure class=\"aligncenter size-full\"><img decoding=\"async\" loading=\"lazy\" width=\"640\" height=\"288\" src=\"https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-62.png?resize=640%2C288&#038;ssl=1\" alt=\"\" class=\"wp-image-1462\" srcset=\"https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-62.png?w=677&amp;ssl=1 677w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-62.png?resize=300%2C135&amp;ssl=1 300w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-62.png?resize=24%2C11&amp;ssl=1 24w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-62.png?resize=36%2C16&amp;ssl=1 36w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-62.png?resize=48%2C22&amp;ssl=1 48w\" sizes=\"(max-width: 640px) 100vw, 640px\" data-recalc-dims=\"1\" \/><\/figure><\/div>\n\n\n\n<p>To fix this, we will create a workaround where we will change the package manager preference. We can do that in <em>\/etc\/apt\/preferences.d<\/em> directory by adding a few lines into the <em>mangodb<\/em> file<\/p>\n\n\n\n<div class=\"is-layout-flow wp-block-group\"><div class=\"wp-block-group__inner-container\">\n<pre class=\"wp-block-preformatted\">sudo vi \/etc\/apt\/preferences.d\/99stretch-mongodb.pref<\/pre>\n<\/div><\/div>\n\n\n\n<p>Now add these lines to the file<\/p>\n\n\n\n<div class=\"is-layout-flow wp-block-group\"><div class=\"wp-block-group__inner-container\">\n<blockquote class=\"wp-block-quote\"><p>#Never Prefer packages from Stretch<\/p><p>Package: * <\/p><p>Pin: release n=stretch <\/p><p>Pin-Priority: 1<\/p><\/blockquote>\n<\/div><\/div>\n\n\n\n<p>Save the file, and now it&#8217;s time to add our repository to <em>\/etc\/apt\/sources.list<\/em><\/p>\n\n\n\n<div class=\"is-layout-flow wp-block-group\"><div class=\"wp-block-group__inner-container\">\n<pre class=\"wp-block-preformatted\">echo \"deb http:\/\/archive.raspbian.org\/raspbian stretch main\" | sudo tee \/etc\/apt\/sources.list.d\/stretch_mongodb.list<\/pre>\n<\/div><\/div>\n\n\n\n<p>When this is done, let&#8217;s move the the last step of installation.<\/p>\n\n\n\n<p><\/p>\n\n\n\n<h2><strong>4. Install the UniFi Controller<\/strong><\/h2>\n\n\n\n<p>We have a few options now, we can just manually download the UniFi controller and install it or we could automate the whole process with package manager and in that way, every time you run apt update, the UniFi controller updates as well.<\/p>\n\n\n\n<p><strong>To do that type<\/strong><\/p>\n\n\n\n<div class=\"is-layout-flow wp-block-group\"><div class=\"wp-block-group__inner-container\">\n<pre class=\"wp-block-preformatted\">echo 'deb [signed-by=\/usr\/share\/keyrings\/ubiquiti-archive-keyring.gpg] https:\/\/www.ui.com\/downloads\/unifi\/debian stable ubiquiti' | sudo tee \/etc\/apt\/sources.list.d\/100-ubnt-unifi.list<\/pre>\n<\/div><\/div>\n\n\n\n<p><strong>And add the GPG key <\/strong><\/p>\n\n\n\n<div class=\"is-layout-flow wp-block-group\"><div class=\"wp-block-group__inner-container\">\n<pre class=\"wp-block-preformatted\">curl https:\/\/dl.ui.com\/unifi\/unifi-repo.gpg | sudo tee \/usr\/share\/keyrings\/ubiquiti-archive-keyring.gpg &gt;\/dev\/null<\/pre>\n<\/div><\/div>\n\n\n\n<p><strong>Finally, update the repositories and install UniFi controller<\/strong><\/p>\n\n\n\n<div class=\"is-layout-flow wp-block-group\"><div class=\"wp-block-group__inner-container\">\n<pre class=\"wp-block-preformatted\">sudo apt update<\/pre>\n\n\n\n<pre class=\"wp-block-preformatted\">sudo apt install unifi<\/pre>\n<\/div><\/div>\n\n\n\n<p><\/p>\n\n\n\n<p>This will automatically start and enable the unifi service. We can check that out by typing<\/p>\n\n\n\n<div class=\"is-layout-flow wp-block-group\"><div class=\"wp-block-group__inner-container\">\n<pre class=\"wp-block-preformatted\">systemctl status unifi<\/pre>\n<\/div><\/div>\n\n\n\n<figure class=\"wp-block-image size-large is-style-default\"><img decoding=\"async\" loading=\"lazy\" width=\"640\" height=\"159\" src=\"https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-63.png?resize=640%2C159&#038;ssl=1\" alt=\"\" class=\"wp-image-1464\" srcset=\"https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-63.png?resize=1024%2C254&amp;ssl=1 1024w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-63.png?resize=300%2C74&amp;ssl=1 300w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-63.png?resize=768%2C190&amp;ssl=1 768w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-63.png?resize=24%2C6&amp;ssl=1 24w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-63.png?resize=36%2C9&amp;ssl=1 36w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-63.png?resize=48%2C12&amp;ssl=1 48w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-63.png?w=1266&amp;ssl=1 1266w\" sizes=\"(max-width: 640px) 100vw, 640px\" data-recalc-dims=\"1\" \/><\/figure>\n\n\n\n<p><\/p>\n\n\n\n<p><\/p>\n\n\n\n<h2><strong>5. Setup the UniFi controller<\/strong><\/h2>\n\n\n\n<p><strong> <\/strong>We could now access the initial setup and the whole interface by typing the following line to our browser on the PI <\/p>\n\n\n\n<div class=\"is-layout-flow wp-block-group\"><div class=\"wp-block-group__inner-container\">\n<pre class=\"wp-block-preformatted\">https:\/\/local.host:8443<\/pre>\n<\/div><\/div>\n\n\n\n<p><\/p>\n\n\n\n<p>But I would like to be able to access this interface from my own PC\/phone. To do that, we need to check and set static IP address on the PI.<\/p>\n\n\n\n<p>To check your IP type<\/p>\n\n\n\n<div class=\"is-layout-flow wp-block-group\"><div class=\"wp-block-group__inner-container\">\n<pre class=\"wp-block-preformatted\">ip a<\/pre>\n<\/div><\/div>\n\n\n\n<figure class=\"wp-block-image size-full is-style-default\"><img decoding=\"async\" loading=\"lazy\" width=\"640\" height=\"191\" src=\"https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-64.png?resize=640%2C191&#038;ssl=1\" alt=\"\" class=\"wp-image-1466\" srcset=\"https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-64.png?w=803&amp;ssl=1 803w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-64.png?resize=300%2C90&amp;ssl=1 300w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-64.png?resize=768%2C230&amp;ssl=1 768w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-64.png?resize=24%2C7&amp;ssl=1 24w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-64.png?resize=36%2C11&amp;ssl=1 36w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-64.png?resize=48%2C14&amp;ssl=1 48w\" sizes=\"(max-width: 640px) 100vw, 640px\" data-recalc-dims=\"1\" \/><\/figure>\n\n\n\n<p><\/p>\n\n\n\n<p>As you can see mine is 192.168.100.30. To do this properly, you should link this IP with your device in your main router, but if you can&#8217;t access it, the best you can do is to set the static IP into your PI.<\/p>\n\n\n\n<div class=\"wp-block-image is-style-default\"><figure class=\"aligncenter size-full\"><img decoding=\"async\" loading=\"lazy\" width=\"330\" height=\"371\" src=\"https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-65.png?resize=330%2C371&#038;ssl=1\" alt=\"\" class=\"wp-image-1467\" srcset=\"https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-65.png?w=330&amp;ssl=1 330w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-65.png?resize=267%2C300&amp;ssl=1 267w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-65.png?resize=21%2C24&amp;ssl=1 21w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-65.png?resize=32%2C36&amp;ssl=1 32w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-65.png?resize=43%2C48&amp;ssl=1 43w\" sizes=\"(max-width: 330px) 100vw, 330px\" data-recalc-dims=\"1\" \/><\/figure><\/div>\n\n\n\n<p><\/p>\n\n\n\n<p>Everything should be now up and ready. All you have to do is type the following line into your browser on main PC.<\/p>\n\n\n\n<div class=\"is-layout-flow wp-block-group\"><div class=\"wp-block-group__inner-container\">\n<pre class=\"wp-block-preformatted\">https:\/\/YOUR_PI_IP:8443\/<\/pre>\n<\/div><\/div>\n\n\n\n<div class=\"wp-block-image is-style-default\"><figure class=\"aligncenter size-large\"><img decoding=\"async\" loading=\"lazy\" width=\"640\" height=\"255\" src=\"https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-66.png?resize=640%2C255&#038;ssl=1\" alt=\"\" class=\"wp-image-1468\" srcset=\"https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-66.png?resize=1024%2C408&amp;ssl=1 1024w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-66.png?resize=300%2C119&amp;ssl=1 300w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-66.png?resize=768%2C306&amp;ssl=1 768w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-66.png?resize=24%2C10&amp;ssl=1 24w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-66.png?resize=36%2C14&amp;ssl=1 36w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-66.png?resize=48%2C19&amp;ssl=1 48w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-66.png?w=1356&amp;ssl=1 1356w, https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/image-66.png?w=1280&amp;ssl=1 1280w\" sizes=\"(max-width: 640px) 100vw, 640px\" data-recalc-dims=\"1\" \/><\/figure><\/div>\n","protected":false},"excerpt":{"rendered":"<p>If you are like me, and you own some Ubiquiti AP, you&#8217;ve probably come across [&hellip;]<\/p>\n","protected":false},"author":1,"featured_media":1470,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":{"nf_dc_page":"","om_disable_all_campaigns":false,"_mi_skip_tracking":false},"categories":[96],"tags":[506,110,112,505],"jetpack_featured_media_url":"https:\/\/i0.wp.com\/thetechcorner.org\/wp-content\/uploads\/2022\/03\/unifi-contoller.png?fit=1280%2C720&ssl=1","_links":{"self":[{"href":"https:\/\/thetechcorner.org\/index.php?rest_route=\/wp\/v2\/posts\/1459"}],"collection":[{"href":"https:\/\/thetechcorner.org\/index.php?rest_route=\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/thetechcorner.org\/index.php?rest_route=\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/thetechcorner.org\/index.php?rest_route=\/wp\/v2\/users\/1"}],"replies":[{"embeddable":true,"href":"https:\/\/thetechcorner.org\/index.php?rest_route=%2Fwp%2Fv2%2Fcomments&post=1459"}],"version-history":[{"count":5,"href":"https:\/\/thetechcorner.org\/index.php?rest_route=\/wp\/v2\/posts\/1459\/revisions"}],"predecessor-version":[{"id":1471,"href":"https:\/\/thetechcorner.org\/index.php?rest_route=\/wp\/v2\/posts\/1459\/revisions\/1471"}],"wp:featuredmedia":[{"embeddable":true,"href":"https:\/\/thetechcorner.org\/index.php?rest_route=\/wp\/v2\/media\/1470"}],"wp:attachment":[{"href":"https:\/\/thetechcorner.org\/index.php?rest_route=%2Fwp%2Fv2%2Fmedia&parent=1459"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/thetechcorner.org\/index.php?rest_route=%2Fwp%2Fv2%2Fcategories&post=1459"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/thetechcorner.org\/index.php?rest_route=%2Fwp%2Fv2%2Ftags&post=1459"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}